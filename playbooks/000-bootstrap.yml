---
- hosts: all
  tasks:
    - name: ensure apt is configured
      tags: apt
      ansible.builtin.include_role:
        name: apt
        apply:
          tags: apt

    - name: ensure system is configured
      tags: system
      ansible.builtin.include_role:
        name: system
        apply:
          tags: system

    - name: ensure oh-my-zsh is configured
      tags: oh_my_zsh
      ansible.builtin.include_role:
        name: oh_my_zsh
        apply:
          tags: oh_my_zsh

    - name: ensure sshd is configured
      tags: sshd
      ansible.builtin.include_role:
        name: sshd
        apply:
          tags: sshd

    - name: ensure bind9 is configured
      when: ansible_hostname in bind9_zones | default([]) | json_query('[*].master')
      tags: bind9
      ansible.builtin.include_role:
        name: bind9
        apply:
          tags: bind9
